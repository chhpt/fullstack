<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>模块化 | The Web Full Stack Way</title>
    <meta name="description" content="">
    
    
    <link rel="preload" href="/the-web-full-stack-way/assets/css/0.styles.3056b2c5.css" as="style"><link rel="preload" href="/the-web-full-stack-way/assets/js/app.dff1fe44.js" as="script"><link rel="preload" href="/the-web-full-stack-way/assets/js/2.8ee5bc96.js" as="script"><link rel="preload" href="/the-web-full-stack-way/assets/js/34.b26bb4f1.js" as="script"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/10.2550531a.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/11.cc4adeb6.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/12.1c025440.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/13.0d61cc70.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/14.53aedd3b.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/15.eb171c41.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/16.92faf436.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/17.ac5348f2.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/18.dc4be0ff.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/19.78f449e0.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/20.2063f954.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/21.b160392b.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/22.01331b4f.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/23.031f0590.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/24.2232d8ac.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/25.e36d5f4d.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/26.461441b5.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/27.d74c09a4.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/28.9f491019.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/29.5b0179fa.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/3.4d4f8ba6.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/30.1aa8fdcf.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/31.8c0c7965.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/32.13dd296a.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/33.e199369a.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/35.6c2f0c1c.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/36.d1230e8f.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/37.a5440c4a.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/38.68e233cd.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/39.82a68217.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/4.9399cf38.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/40.ee05a853.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/41.70eb3123.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/42.bdf5d12f.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/43.88fccc01.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/44.8474d8d4.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/45.9f28ef5e.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/46.46789ba1.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/47.0a0de53e.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/48.decce713.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/49.4efd53b8.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/5.e8dc4e00.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/50.68747882.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/51.30423e7a.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/52.b70f825e.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/53.bb2f6077.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/54.eb291fe7.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/55.5938d910.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/56.00a62f7f.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/57.d423eee5.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/58.ca1a597c.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/59.f59eb3b3.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/6.17fa9d05.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/60.4668ad5d.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/61.de67c066.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/62.12272ef3.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/63.ae2c1d14.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/64.e75d0dcc.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/65.55c84147.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/66.861ca046.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/67.c240828d.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/68.4f5e5fdc.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/69.57ee58a5.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/7.cc86b3d8.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/70.9839e394.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/71.3c53d3ae.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/72.1c0329cd.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/73.ae757602.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/74.3a845297.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/75.de258d64.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/76.c8c70648.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/77.e83cd1dd.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/78.6fac5a75.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/79.17351627.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/8.c9b741f5.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/80.9e5e5cb1.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/81.00349d5d.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/82.055f5653.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/83.21eeb02b.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/84.650040e3.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/85.578467eb.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/86.ede8c4a4.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/87.53f4a81b.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/88.5662d22a.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/89.57dff66c.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/9.77d00260.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/90.2309fb63.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/91.d1bd3fbc.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/92.01f1d6f4.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/93.f8b5b624.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/94.cd4472f2.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/95.98f8a226.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/96.7347b5c5.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/97.27c49586.js"><link rel="prefetch" href="/the-web-full-stack-way/assets/js/98.38b646a2.js">
    <link rel="stylesheet" href="/the-web-full-stack-way/assets/css/0.styles.3056b2c5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/the-web-full-stack-way/" class="home-link router-link-active"><!----> <span class="site-name">The Web Full Stack Way</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/the-web-full-stack-way/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/the-web-full-stack-way/data-structure-and-algorithms/" class="nav-link">数据结构与算法</a></li><li class="dropdown-item"><!----> <a href="/the-web-full-stack-way/operating-system/" class="nav-link">操作系统</a></li><li class="dropdown-item"><!----> <a href="/the-web-full-stack-way/network/" class="nav-link">网络</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Web 前端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/the-web-full-stack-way/html&amp;css/" class="nav-link">HTML&amp;CSS</a></li><li class="dropdown-item"><!----> <a href="/the-web-full-stack-way/javascript/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/the-web-full-stack-way/engineering/" class="nav-link router-link-active">工程化</a></li><li class="dropdown-item"><!----> <a href="/the-web-full-stack-way/framework/" class="nav-link">框架</a></li><li class="dropdown-item"><!----> <a href="/the-web-full-stack-way/mini-program/" class="nav-link">小程序</a></li></ul></div></div><div class="nav-item"><a href="/the-web-full-stack-way/node/" class="nav-link">Node</a></div><div class="nav-item"><a href="/the-web-full-stack-way/database/" class="nav-link">数据库</a></div><div class="nav-item"><a href="/the-web-full-stack-way/docker/" class="nav-link">Docker</a></div><div class="nav-item"><a href="/the-web-full-stack-way/tools/" class="nav-link">工具</a></div><div class="nav-item"><a href="https://github.com/chhpt/the-web-full-stack-way" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/the-web-full-stack-way/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/the-web-full-stack-way/data-structure-and-algorithms/" class="nav-link">数据结构与算法</a></li><li class="dropdown-item"><!----> <a href="/the-web-full-stack-way/operating-system/" class="nav-link">操作系统</a></li><li class="dropdown-item"><!----> <a href="/the-web-full-stack-way/network/" class="nav-link">网络</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">Web 前端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/the-web-full-stack-way/html&amp;css/" class="nav-link">HTML&amp;CSS</a></li><li class="dropdown-item"><!----> <a href="/the-web-full-stack-way/javascript/" class="nav-link">JavaScript</a></li><li class="dropdown-item"><!----> <a href="/the-web-full-stack-way/engineering/" class="nav-link router-link-active">工程化</a></li><li class="dropdown-item"><!----> <a href="/the-web-full-stack-way/framework/" class="nav-link">框架</a></li><li class="dropdown-item"><!----> <a href="/the-web-full-stack-way/mini-program/" class="nav-link">小程序</a></li></ul></div></div><div class="nav-item"><a href="/the-web-full-stack-way/node/" class="nav-link">Node</a></div><div class="nav-item"><a href="/the-web-full-stack-way/database/" class="nav-link">数据库</a></div><div class="nav-item"><a href="/the-web-full-stack-way/docker/" class="nav-link">Docker</a></div><div class="nav-item"><a href="/the-web-full-stack-way/tools/" class="nav-link">工具</a></div><div class="nav-item"><a href="https://github.com/chhpt/the-web-full-stack-way" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>工程化</span> <!----></p> <ul class="sidebar-group-items"><li><a href="/the-web-full-stack-way/engineering/" class="sidebar-link">前端工程化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/the-web-full-stack-way/engineering/#webpack" class="sidebar-link">webpack</a></li><li class="sidebar-sub-header"><a href="/the-web-full-stack-way/engineering/#模块化" class="sidebar-link">模块化</a></li></ul></li><li><a href="/the-web-full-stack-way/engineering/modular.html" class="active sidebar-link">模块化</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/the-web-full-stack-way/engineering/modular.html#解释-javascript-模块模式" class="sidebar-link">解释 JavaScript 模块模式</a></li><li class="sidebar-sub-header"><a href="/the-web-full-stack-way/engineering/modular.html#模块化的优点" class="sidebar-link">模块化的优点</a></li><li class="sidebar-sub-header"><a href="/the-web-full-stack-way/engineering/modular.html#模块模式的实现" class="sidebar-link">模块模式的实现</a></li><li class="sidebar-sub-header"><a href="/the-web-full-stack-way/engineering/modular.html#commonjs，amd，umd-和-es6-的模块" class="sidebar-link">CommonJS，AMD，UMD 和 ES6 的模块</a></li><li class="sidebar-sub-header"><a href="/the-web-full-stack-way/engineering/modular.html#node-中的-require-exports-和-es6-中的-import-export-区别" class="sidebar-link">Node 中的 require/exports 和 ES6 中的 import/export 区别</a></li></ul></li><li><a href="/the-web-full-stack-way/engineering/webpack/" class="sidebar-link">Webpack</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/the-web-full-stack-way/engineering/webpack/#值得读的文章" class="sidebar-link">值得读的文章</a></li></ul></li><li><a href="/the-web-full-stack-way/engineering/webpack/webpack_1.html" class="sidebar-link">webpack 入门一</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/the-web-full-stack-way/engineering/webpack/webpack_1.html#为什么要使用-webpack" class="sidebar-link">为什么要使用 webpack</a></li><li class="sidebar-sub-header"><a href="/the-web-full-stack-way/engineering/webpack/webpack_1.html#webpack-是什么-🤔" class="sidebar-link">webpack 是什么 🤔</a></li><li class="sidebar-sub-header"><a href="/the-web-full-stack-way/engineering/webpack/webpack_1.html#webpack-安装-⚙" class="sidebar-link">webpack 安装 ⚙</a></li><li class="sidebar-sub-header"><a href="/the-web-full-stack-way/engineering/webpack/webpack_1.html#简单使用-webpack-🌰" class="sidebar-link">简单使用 webpack 🌰</a></li></ul></li><li><a href="/the-web-full-stack-way/engineering/webpack/webpack_2.html" class="sidebar-link">webpack 入门二</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/the-web-full-stack-way/engineering/webpack/webpack_2.html#webpack-的核心概念" class="sidebar-link">webpack 的核心概念</a></li><li class="sidebar-sub-header"><a href="/the-web-full-stack-way/engineering/webpack/webpack_2.html#loader" class="sidebar-link">loader</a></li><li class="sidebar-sub-header"><a href="/the-web-full-stack-way/engineering/webpack/webpack_2.html#插件-plugins" class="sidebar-link">插件 (plugins)</a></li></ul></li><li><a href="/the-web-full-stack-way/engineering/webpack/loader.html" class="sidebar-link">Webpack Loader</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/the-web-full-stack-way/engineering/webpack/loader.html#什么是-loader" class="sidebar-link">什么是 Loader</a></li><li class="sidebar-sub-header"><a href="/the-web-full-stack-way/engineering/webpack/loader.html#使用-loader" class="sidebar-link">使用 Loader</a></li><li class="sidebar-sub-header"><a href="/the-web-full-stack-way/engineering/webpack/loader.html#编写-loader" class="sidebar-link">编写 Loader</a></li></ul></li></ul></div></li></ul> </div> <div class="page"> <div class="content default"><h1 id="模块化"><a href="#模块化" aria-hidden="true" class="header-anchor">#</a> 模块化</h1> <h2 id="解释-javascript-模块模式"><a href="#解释-javascript-模块模式" aria-hidden="true" class="header-anchor">#</a> 解释 JavaScript 模块模式</h2> <p>模块模式和我们平常所说的模块化的理念比较接近，但不仅仅是指依赖于 <code>module</code> 的实现。模块模式一般用来模拟类的概念（因为原生 JavaScript 并不支持类，虽然最新的 ES6 里引入了 Class 不过还不普及）这样我们就能把公有和私有方法还有变量存储在一个对象中——这就和我们在 Java 或 Python 里使用类的感觉一样。这样我们就能在公开调用 API 的同时，仍然在一个闭包范围内封装私有变量和方法。</p> <h2 id="模块化的优点"><a href="#模块化的优点" aria-hidden="true" class="header-anchor">#</a> 模块化的优点</h2> <p>网页越来越像桌面程序，需要一个团队分工协作、进度管理、单元测试等等...... 开发者不得不使用软件工程的方法，管理网页的业务逻辑。我们无法保证自己所写的代码与他人不发生冲突，同时处于可维护性，重用性等诸多方面的因素，我们需要某种 <strong>类</strong> 的理念来帮助我们管理我们的代码。</p> <p>模块是任何健壮的应用程序体系结构不可或缺的一部分，特点是有助于保持应用项目的代码单元既能清晰地分离又有组织。模块化可以使你的代码低耦合，功能模块直接不相互影响。</p> <h3 id="主要优点"><a href="#主要优点" aria-hidden="true" class="header-anchor">#</a> 主要优点</h3> <ul><li><p><strong>可维护性</strong>：根据定义，每个模块都是独立的。良好设计的模块会尽量与外部的代码撇清关系，以便于独立对其进行改进和维护。维护一个独立的模块比起一团凌乱的代码来说要轻松很多。</p></li> <li><p><strong>命名空间</strong>：在 JavaScript 中，最高级别的函数外定义的变量都是全局变量（这意味着所有人都可以访问到它们）。也正因如此，当一些无关的代码碰巧使用到同名变量的时候，我们就会遇到 “命名空间污染” 的问题。这样的问题在我们开发过程中是要极力避免的。</p></li> <li><p><strong>可复用性</strong>：现实来讲，在日常工作中我们经常会复制自己之前写过的代码到新项目中。复制粘贴虽然很快很方便，但难道我们找不到更好的办法了么？要是…… 有一个可以重复利用的模块岂不妙哉？</p></li></ul> <h2 id="模块模式的实现"><a href="#模块模式的实现" aria-hidden="true" class="header-anchor">#</a> 模块模式的实现</h2> <h3 id="匿名闭包函数"><a href="#匿名闭包函数" aria-hidden="true" class="header-anchor">#</a> 匿名闭包函数</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 在函数的作用域中下面的变量是私有的</span>
  <span class="token comment">// 变量方法任然能访问全局变量</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>通过这种构造，我们的匿名函数有了自己的作用域或闭包。这允许我们从父（全局）命名空间隐藏变量。这种方法的好处在于，你可以在函数内部使用局部变量，而不会意外覆盖同名全局变量，但仍然能够访问到全局变量。要注意的是，一定要用括号把匿名函数包起来，以关键词 function 开头的语句总是会被解释成函数声明（JS 中不允许没有命名的函数声明），而加上括号后，内部的代码就会被识别为函数表达式。其实这个也叫作立即执行函数（IIFE）。</p> <h3 id="引入全局变量"><a href="#引入全局变量" aria-hidden="true" class="header-anchor">#</a> 引入全局变量</h3> <p>JavaScript 有个特性，称为隐性全局。使用变量名称时，解释器会从作用域向后寻找变量声明。如果没找到，变量会被假定入全局（以后可以全局调用）。如果会被分配使用，在还不存在时全局创建它。这意味着在匿名函数里使用全局变量很简单。不幸的是，这会导致代码难以管理，文件中不容易区分（对人而言）哪个变量是全局的。</p> <p>幸好，匿名函数还有一个不错的选择。全局变量作为参数传递给匿名函数。将它们引入我们的代码中，既更清晰，又比使用隐性全局更快。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>globalVariable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 在函数的作用域中下面的变量是私有的</span>
  <span class="token keyword">var</span> <span class="token function-variable function">privateFunction</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Shhhh, this is private!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token comment">// 访问全局变量</span>
  <span class="token keyword">var</span> a <span class="token operator">=</span> globalVariable<span class="token punctuation">.</span>a<span class="token punctuation">;</span>

  <span class="token comment">// 通过全局变量设置下列方法的外部访问接口</span>
  <span class="token comment">// 与此同时这些方法又都在函数内部</span>
  globalVariable<span class="token punctuation">.</span><span class="token function-variable function">each</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span>collection<span class="token punctuation">,</span> iterator<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>collection<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> collection<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">iterator</span><span class="token punctuation">(</span>collection<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> i<span class="token punctuation">,</span> collection<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> key <span class="token keyword">in</span> collection<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">iterator</span><span class="token punctuation">(</span>collection<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> collection<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>globalVariable<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="模块的接口"><a href="#模块的接口" aria-hidden="true" class="header-anchor">#</a> 模块的接口</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> GradesModule <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 在函数的作用域中下面的变量是私有的</span>
  <span class="token keyword">var</span> myGrades <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">93</span><span class="token punctuation">,</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">55</span><span class="token punctuation">,</span> <span class="token number">91</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token comment">// 通过接口在外部访问下列方法</span>
  <span class="token comment">// 与此同时这些方法又都在函数内部</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    average<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> avg <span class="token operator">=</span>
        myGrades<span class="token punctuation">.</span><span class="token function">reduce</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>prev<span class="token punctuation">,</span> current<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> prev <span class="token operator">+</span> current<span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">/</span> myGrades<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
      <span class="token keyword">return</span> avg<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>

    getGrades<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> myGrades<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>我们声明了一个全局变量 <code>GradesModule</code>，暴露两个接口 <code>average</code> 和 <code>getGrades</code>，通过这两个接口，我们可以访问 <code>Grades</code> 的私有变量。</p> <h3 id="扩展"><a href="#扩展" aria-hidden="true" class="header-anchor">#</a> 扩展</h3> <p>模块模式的一个限制是整个模块必须在一个文件里，但是在一些大型项目里，将一个功能分离成多个文件是非常重要的，因为可以多人合作易于开发。那么我们怎么在一个文件引入另一个文件的模块，而不对另一个模块造成影响呢？还好，我们有很好的办法扩充模块。（在扩充文件）首先我们引入模块（从全局），给他添加属性，再输出他。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token constant">MODULE</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 给引入的模块添加方法</span>
  my<span class="token punctuation">.</span><span class="token function-variable function">anotherMethod</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> my<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token constant">MODULE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="松耦合扩展"><a href="#松耦合扩展" aria-hidden="true" class="header-anchor">#</a> 松耦合扩展</h3> <p>上面的例子需要我们首先创建模块，然后扩充它，这并不总是必要的。提升 JavaScript 应用性能最好的操作就是异步加载脚本。因而我们可以创建灵活多部分的模块，可以将他们无顺序加载，以松耦合扩充。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token constant">MODULE</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// add capabilities...</span>
  <span class="token keyword">return</span> my<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token constant">MODULE</span> <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>通过这样的代码，** 每个单独分离的文件都保证这个结构 **，那么我们就可以实现任意顺序的加载，所以，这个时候的 <code>var</code> 就是必须要声明的，因为不声明，其它文件读取不到哦。</p> <p>A.js 文件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 声明一个模块</span>
<span class="token keyword">var</span> AModule <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span>privateProperties <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  module<span class="token punctuation">.</span><span class="token function-variable function">methods</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> moudle<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>AModule <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>B.js 文件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 引入模块，并添加方法</span>
<span class="token keyword">var</span> AModule <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>module<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  module<span class="token punctuation">.</span><span class="token function-variable function">newMethods</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> module<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span>AModule <span class="token operator">||</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="紧耦合扩充"><a href="#紧耦合扩充" aria-hidden="true" class="header-anchor">#</a> 紧耦合扩充</h3> <p>虽然松耦合很不错，但模块上也有些限制，你不能重写模块属性（因为没有加载顺序）。初始化时也无法使用其他文件定义的模块属性（但你可以在初始化后运行）。紧耦合扩充意味着一组加载顺序，但是允许覆写。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> <span class="token constant">MODULE</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span>my<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> old_moduleMethod <span class="token operator">=</span> my<span class="token punctuation">.</span>moduleMethod<span class="token punctuation">;</span>
  my<span class="token punctuation">.</span><span class="token function-variable function">moduleMethod</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// method override, has access to old through old_moduleMethod...</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> my<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token constant">MODULE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="commonjs，amd，umd-和-es6-的模块"><a href="#commonjs，amd，umd-和-es6-的模块" aria-hidden="true" class="header-anchor">#</a> CommonJS，AMD，UMD 和 ES6 的模块</h2> <p>上述的所有解决方案都有一个共同点：使用单个全局变量来把所有的代码包含在一个函数内，由此来创建私有的命名空间和闭包作用域。</p> <p>虽然每种方法都比较有效，但也都有各自的短板。</p> <p>有一点，作为开发者，你必须清楚地了解引入依赖文件的正确顺序。就拿 Backbone.js 来举个例子，想要使用 Backbone 就必须在你的页面里引入 Backbone 的源文件。</p> <p>然而 Backbone 又依赖 Underscore.js，所以 Backbone 的引入必须在其之后。</p> <p>而在工作中，这些依赖管理经常会成为让人头疼的问题。</p> <p>另外一点，这些方法也有可能引起命名空间冲突。举个例子，要是你碰巧写了俩重名的模块怎么办？或者你同时需要一个模块的两个版本时该怎么办？</p> <p>难道就没有不通过全局作用域来实现的模块方法么？</p> <p>当然是有的。</p> <p>接下来介绍两种广受欢迎的解决方案：CommonJS 和 AMD。</p> <h3 id="commonjs"><a href="#commonjs" aria-hidden="true" class="header-anchor">#</a> <a href="https://www.wikiwand.com/en/CommonJS" target="_blank" rel="noopener noreferrer">CommonJS<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h3> <p>CommonJS 是 <strong>以在浏览器环境之外</strong> 构建 JavaScript 生态系统为目标而产生的项目，比如在 <strong>服务器</strong> 和桌面环境中。CommonJS 规范是为了解决 JavaScript 的作用域问题而定义的模块形式，可以使每个模块它自身的命名空间中执行。该规范的主要内容是，模块必须通过 module.exports 导出对外的变量或接口，通过 require() 来导入其他模块的输出到当前模块作用域中。</p> <p>A 文件中定义模块</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">myModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">hello</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'hello!'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function-variable function">goodbye</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">'goodbye!'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> myModule<span class="token punctuation">;</span>
</code></pre></div><p>B 文件中引用模块</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> myModule <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'myModule'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">var</span> myModuleInstance <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">myModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
myModuleInstance<span class="token punctuation">.</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'hello!'</span>
myModuleInstance<span class="token punctuation">.</span><span class="token function">goodbye</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 'goodbye!'</span>
</code></pre></div><p>需要注意的一点是，CommonJS 以服务器优先的方式来同步载入模块，假使我们引入三个模块的话，他们会一个个地被载入。</p> <p>它在服务器端用起来很爽，可是在浏览器里就不会那么高效了。毕竟读取网络的文件要比本地耗费更多时间，只要它还在读取模块，浏览器载入的页面就会一直卡着不动。</p> <h3 id="amd"><a href="#amd" aria-hidden="true" class="header-anchor">#</a> <a href="https://github.com/amdjs/amdjs-api/wiki" target="_blank" rel="noopener noreferrer">AMD<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></h3> <p>CommonJS 已经挺不错了，但假使我们想要实现异步加载模块该怎么办？答案就是 <code>Asynchronous Module Definition（异步模块定义规范）</code>，简称 AMD。AMD 是为浏览器环境设计的，因为 CommonJS 模块系统是同步加载的，当前浏览器环境还没有准备好同步加载模块的条件。</p> <p>AMD 定义了一套 JavaScript 模块依赖异步加载标准，来解决同步加载的问题。</p> <p>模块通过 define 函数定义在闭包中，格式如下：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">define</span><span class="token punctuation">(</span>id<span class="token operator">?</span><span class="token punctuation">:</span> String<span class="token punctuation">,</span> dependencies<span class="token operator">?</span><span class="token punctuation">:</span> String<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> factory<span class="token punctuation">:</span> Function<span class="token operator">|</span>Object<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>id 是模块的名字，它是可选的参数。</p> <p>dependencies 指定了所要依赖的模块列表，它是一个数组，也是可选的参数，每个依赖的模块的输出将作为参数一次传入 factory 中。如果没有指定 dependencies，那么它的默认值是 [&quot;require&quot;, &quot;exports&quot;, &quot;module&quot;]。factory 是最后一个参数，它包裹了模块的具体实现，它是一个函数或者对象。如果是函数，那么它的返回值就是模块的输出接口或值，函数将会使用载入的模块作为参数。</p> <p>定义一个名为 myModule 的模块，它依赖 jQuery 模块：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">define</span><span class="token punctuation">(</span><span class="token string">'myModule'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'jquery'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>$<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// $ 是 jquery 模块的输出</span>
  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">'body'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 使用</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'myModule'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span>myModule<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>myModule<span class="token punctuation">.</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>重申一下，不像 CommonJS，AMD 是优先浏览器的一种异步载入模块的解决方案。除了异步加载以外，AMD 的 另一个优点是你可以在模块里使用对象、函数、构造函数、字符串、JSON 或者别的数据类型，而 CommonJS 只支持对象。再补充一点，AMD 不支持 Node 里的一些诸如 IO, 文件系统等其他服务器端的功能。另外语法上写起来也比 CommonJS 麻烦一些。</p> <h3 id="umd"><a href="#umd" aria-hidden="true" class="header-anchor">#</a> UMD</h3> <p>在一些同时需要 AMD 和 CommonJS 功能的项目中，你需要使用另一种规范：Universal Module Definition（通用模块定义规范）。</p> <p>UMD 创造了一种同时使用两种规范的方法，并且也支持全局变量定义。所以 UMD 的模块可以同时在客户端和服务端使用。</p> <h3 id="es6-模块"><a href="#es6-模块" aria-hidden="true" class="header-anchor">#</a> ES6 模块</h3> <p>上述的这几种方法都不是 JS 原生支持的。要么是通过模块模式来模拟，要么是使用 CommonJS 或 AMD.</p> <p>幸运的是在 JS 的最新规范 ECMAScript 6 (ES6) 中，引入了模块功能。ES6 的模块功能汲取了 CommonJS 和 AMD 的优点，拥有简洁的语法并支持异步加载，并且还有其他诸多更好的支持。ES6 在语言标准的层面上，实现了模块功能，而且实现得相当简单，完全可以取代 CommonJS 和 AMD 规范，成为浏览器和服务器通用的模块解决方案。</p> <p>ES6 模块的设计思想，是尽量的静态化，使得编译时就能确定模块的依赖关系，以及输入和输出的变量。CommonJS 和 AMD 模块，都只能在运行时确定这些东西。比如，CommonJS 模块就是对象，输入时必须查找对象属性。</p> <p>模块功能主要由两个命令构成：<code>export</code> 和 <code>import</code>。<code>export</code> 命令用于规定模块的对外接口，<code>import</code> 命令用于输入其他模块提供的功能。</p> <p>A.js 文件</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">var</span> firstName <span class="token operator">=</span> <span class="token string">'Michael'</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> <span class="token function-variable function">getName</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> firstName<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token punctuation">{</span> firstName<span class="token punctuation">,</span> getName <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>导入模块</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> firstName<span class="token punctuation">,</span> getName <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./A.js'</span><span class="token punctuation">;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>firstName<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Michael</span>
</code></pre></div><p>这里只是简单的介绍 ES6 的模块语法，想深入了解的同学可以看 <a href="http://es6.ruanyifeng.com/#docs/module" target="_blank" rel="noopener noreferrer">这里<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。</p> <h3 id="参考"><a href="#参考" aria-hidden="true" class="header-anchor">#</a> 参考</h3> <ul><li><a href="https://zhuanlan.zhihu.com/p/22890374" target="_blank" rel="noopener noreferrer">JavaScript 模块化入门 Ⅰ：理解模块<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://colobu.com/2014/09/23/JavaScript-Module-Pattern-In-Depth/#%E6%A8%A1%E5%9D%97%E5%87%BA%E5%8F%A3" target="_blank" rel="noopener noreferrer">深入理解 JavaScript 模块模式<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://zhaoda.net/webpack-handbook/module-system.html" target="_blank" rel="noopener noreferrer">模块系统的演进<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://zhaoda.net/webpack-handbook/amd.html" target="_blank" rel="noopener noreferrer">AMD 规范<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://es6.ruanyifeng.com/#docs/module" target="_blank" rel="noopener noreferrer">Module 的语法<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="node-中的-require-exports-和-es6-中的-import-export-区别"><a href="#node-中的-require-exports-和-es6-中的-import-export-区别" aria-hidden="true" class="header-anchor">#</a> Node 中的 require/exports 和 ES6 中的 import/export 区别</h2> <h3 id="遵循的规范不同，语法不同"><a href="#遵循的规范不同，语法不同" aria-hidden="true" class="header-anchor">#</a> 遵循的规范不同，语法不同</h3> <p>Node 中模块借鉴于 CommonJS 规范，ES6 的模块是标准的 ECMAScript 语法。</p> <p>语法部分不做详细介绍，可以看看官方的介绍。</p> <h3 id="变量的加载"><a href="#变量的加载" aria-hidden="true" class="header-anchor">#</a> 变量的加载</h3> <h4 id="commonjs-2"><a href="#commonjs-2" aria-hidden="true" class="header-anchor">#</a> CommonJS</h4> <p>当导出一个变量时，导出的是变量的拷贝值。对于基本数据类型，属于复制。同时，在另一个模块可以对该模块输出的变量重新赋值。对于复杂数据类型，属于浅拷贝。由于两个模块引用的对象指向同一个内存空间，因此对该模块的值做修改时会影响另一个模块。</p> <p>当使用 require 命令加载某个模块时，就会运行整个模块的代码，属于同步执行，当 require() 方法返回时，我们就得到了我们相应的变量，并且可以使用它的值，所有的这些事情都发生在 Node.js 进程事件循环的同一个周期里。此外，引入的模块会被缓存，当使用 require 命令加载同一个模块时，不会再执行该模块，而是取到缓存之中的值。也就是说，commonjs 模块无论加载多少次，都只会在第一次加载时运行一次，以后再加载，就返回第一次运行的结果，除非手动清除系统缓存。</p> <h4 id="es6-模块-2"><a href="#es6-模块-2" aria-hidden="true" class="header-anchor">#</a> ES6 模块</h4> <p>ES6 模块的运行机制与 CommonJS 不一样。JS 引擎对脚本静态分析的时候，遇到模块加载命令 import，就会生成一个只读引用。等到脚本真正执行时，再根据这个只读引用，到被加载的那个模块里面去取值。ES6 模块是动态只读引用，并且不会缓存值，模块里面的变量绑定其所在的模块。即不允许修改引入变量的值，且当原始值发生变化时，import 加载的值也会发生改变。</p> <p>ES6 模块是动态引用，如果使用 import 从一个模块加载变量，不会立刻执行整个模块，而是保存一个对变量的引用，等到脚本真正执行时，再根据这个只读引用，到被加载的那个模块里面去取值。此外，ES6 中是允许这个解析的步骤异步执行的。这就意味着，在 ES6 的机制中，加载脚本内容、解析模块的 import 和 export，执行模块代码将发生在多个事件循环里。</p> <h3 id="循环加载"><a href="#循环加载" aria-hidden="true" class="header-anchor">#</a> 循环加载</h3> <p>循环加载（circular dependency）指的是，a 脚本的执行依赖 b 脚本，而 b 脚本的执行又依赖 a 脚本。</p> <h4 id="commonjs-3"><a href="#commonjs-3" aria-hidden="true" class="header-anchor">#</a> CommonJS</h4> <p>CommonJS 模块的重要特性是加载时执行，即脚本代码在 require 的时候，就会全部执行。一旦出现某个模块被 &quot;循环加载&quot;，就只输出已经执行的部分，还未执行的部分不会输出。</p> <h4 id="es6"><a href="#es6" aria-hidden="true" class="header-anchor">#</a> ES6</h4> <p>循环加载时，ES6 模块是动态引用。只要两个模块之间存在某个引用，代码就能够执行。</p> <ul><li>import/export 最终都是编译为 require/exports 来执行的。
CommonJS 规范规定，每个模块内部，module 变量代表当前模块。这个变量是一个对象，它的 exports 属性（即 module.exports ）是对外的接口。加载某个模块，其实是加载该模块的 module.exports 属性。</li> <li>export 命令规定的是对外的接口，必须与模块内部的变量建立一一对应关系。</li></ul> <h3 id="参考-2"><a href="#参考-2" aria-hidden="true" class="header-anchor">#</a> 参考</h3> <ul><li><a href="http://es6.ruanyifeng.com/#docs/module-loader" target="_blank" rel="noopener noreferrer">Module 的加载实现<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="http://www.cnblogs.com/unclekeith/p/7679503.html" target="_blank" rel="noopener noreferrer">commonjs 模块与 es6 模块的区别<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://aotu.io/notes/2017/04/22/an-update-on-es6-modules-in-node-js/index.html" target="_blank" rel="noopener noreferrer">关于 Node.js 里 ES6 Modules 的一次更新说明<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div> <div class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">2019-3-29 15:01:41</span></div></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/the-web-full-stack-way/engineering/" class="prev router-link-active">
          前端工程化
        </a></span> <span class="next"><a href="/the-web-full-stack-way/engineering/webpack/">
          Webpack
        </a>
        →
      </span></p></div> </div></div><div class="global-ui"></div></div>
    <script src="/the-web-full-stack-way/assets/js/app.dff1fe44.js" defer></script><script src="/the-web-full-stack-way/assets/js/2.8ee5bc96.js" defer></script><script src="/the-web-full-stack-way/assets/js/34.b26bb4f1.js" defer></script>
  </body>
</html>
