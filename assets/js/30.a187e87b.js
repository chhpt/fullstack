(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{272:function(a,t,s){"use strict";s.r(t);var e=s(0),n=Object(e.a)({},(function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("p",[a._v("最近，双十一临近，各种商家也逐渐开始了促销，"),s("a",{attrs:{href:"https://cloud.tencent.com/act/double11/reserve?spread_hash_key=2eGL1O",target:"_blank",rel:"noopener noreferrer"}},[a._v("腾讯云推出了双十一活动"),s("OutboundLink")],1),a._v("，2 核 4 G，5M 的服务器 3 年只需 998 元，很是划算，随入手了一台服务器用作自用，打算将这台服务器当做未来几年的主力服务器。")]),a._v(" "),s("p",[a._v("既然是主力服务器，必然考虑到各种情况，数据安全性是很重要的一点，如果直接把数据放在系统盘中，难免遇到什么特殊情况，需要重装系统盘，数据就可能需要迁移，十分不便。于是我决定购买一个数据盘，单独存放数据使用，并启动数据盘的定时快照功能，就能保障数据的安全性了。")]),a._v(" "),s("p",[a._v("为了让 Linux 系统能够正常使用这块磁盘，要先对磁盘进行一些初始化工作。")]),a._v(" "),s("h2",{attrs:{id:"命令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#命令"}},[a._v("#")]),a._v(" 命令")]),a._v(" "),s("p",[a._v("先了解一下我们要使用到的 Linux 命名：")]),a._v(" "),s("ul",[s("li",[s("code",[a._v("df")]),a._v("：用于显示目前 Linux 系统上的文件系统的磁盘使用情况统计")]),a._v(" "),s("li",[s("code",[a._v("fdisk")]),a._v("：用于管理磁盘分区表")]),a._v(" "),s("li",[s("code",[a._v("mount")]),a._v("：用于挂载 Linux 系统外的文件")]),a._v(" "),s("li",[s("code",[a._v("partprobe")]),a._v("：用于重读分区表，当出现删除文件后，出现仍然占用空间。可以在不重启的情况下重读分区。")]),a._v(" "),s("li",[s("code",[a._v("mkfs")]),a._v(" ：用于在设备上创建Linux文件系统")])]),a._v(" "),s("h2",{attrs:{id:"磁盘分区"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#磁盘分区"}},[a._v("#")]),a._v(" 磁盘分区")]),a._v(" "),s("p",[a._v("第一步，要对磁盘进行格式化分区。")]),a._v(" "),s("h4",{attrs:{id:"_1-查看系统磁盘信息，获取新增加的磁盘设备信息。"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-查看系统磁盘信息，获取新增加的磁盘设备信息。"}},[a._v("#")]),a._v(" 1. 查看系统磁盘信息，获取新增加的磁盘设备信息。")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("fdisk")]),a._v(" -l\n")])])]),s("p",[a._v("回显")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Disk /dev/vda: 50 GiB, 53687091200 bytes, 104857600 sectors\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisklabel type: dos\nDisk identifier: 0x3fa1d255\n\nDevice     Boot Start       End   Sectors Size Id Type\n/dev/vda1  *     2048 104857566 104855519  50G 83 Linux\n\n\nDisk /dev/vdb: 60 GiB, 64424509440 bytes, 125829120 sectors\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\n")])])]),s("p",[a._v("可以看到，当前的服务器上有两个磁盘，一个 50G，一个 60G，50G 的是服务器自带的系统盘，60G 的就是新购买的数据盘，还没有进行过分区操作。")]),a._v(" "),s("h4",{attrs:{id:"_2-对新增的数据盘进行分区操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-对新增的数据盘进行分区操作"}},[a._v("#")]),a._v(" 2. 对新增的数据盘进行分区操作")]),a._v(" "),s("p",[a._v("下面开始对数据盘进行分区操作")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("fdisk")]),a._v(" /dev/vdb\n")])])]),s("p",[a._v("回显")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Welcome to fdisk (util-linux 2.31.1).\nChanges will remain in memory only, until you decide to write them.\nBe careful before using the write command.\n\nDevice does not contain a recognized partition table.\nCreated a new DOS disklabel with disk identifier 0x695b2bd0.\n\nCommand (m for help):\n")])])]),s("p",[a._v("输入 "),s("code",[a._v("n")]),a._v("，回车新建分区")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Command (m for help): n\nPartition type\n   p   primary (0 primary, 0 extended, 4 free)\n   e   extended (container for logical partitions)\nSelect (default p):\n")])])]),s("p",[a._v("这里我们可以看到有两种分区类型：primary（主分区）和 extended（扩展分区），这里选择创建主分区，输入 "),s("code",[a._v("p")]),a._v(" 回车，会提示输入一些信息")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Partition number (1-4, default 1): 1\nFirst sector (2048-125829119, default 2048):\nLast sector, +sectors or +size{K,M,G,T,P} (2048-125829119, default 125829119):\n\nCreated a new partition 1 of type 'Linux' and of size 60 GiB.\n\nCommand (m for help):\n")])])]),s("p",[a._v("由于这个磁盘是全新的，没有任何分区，所以设置分区编号为 1，其他的为默认值，即可创建新的分区。")]),a._v(" "),s("h4",{attrs:{id:"_3-查看分区信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-查看分区信息"}},[a._v("#")]),a._v(" 3. 查看分区信息")]),a._v(" "),s("p",[a._v("创建完分区后，输入 "),s("code",[a._v("p")]),a._v(" 即可查看新创建的分区信息")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Command (m for help): p\n\nDisk /dev/vdb: 60 GiB, 64424509440 bytes, 125829120 sectors\nUnits: sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisklabel type: dos\nDisk identifier: 0x695b2bd0\n\nDevice     Boot Start       End   Sectors Size Id Type\n/dev/vdb1        2048 125829119 125827072  60G 83 Linux\n")])])]),s("h4",{attrs:{id:"_4-将分区结果写入分区表中"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-将分区结果写入分区表中"}},[a._v("#")]),a._v(" 4. 将分区结果写入分区表中")]),a._v(" "),s("p",[a._v("确认分区信息后，输入 "),s("code",[a._v("w")]),a._v(" 回车即可将分区结果写入分区表中")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Command (m for help): w\n\nThe partition table has been altered.\nCalling ioctl() to re-read partition table.\nSyncing disks.\n")])])]),s("p",[a._v("如上，表示分区创建完成。如果之前分区操作有误，请输入 "),s("code",[a._v("q")]),a._v("，则会退出 fdisk 分区工具，之前的分区结果将不会被保留。")]),a._v(" "),s("h4",{attrs:{id:"_5-将新的分区表变更同步至操作系统"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-将新的分区表变更同步至操作系统"}},[a._v("#")]),a._v(" 5. 将新的分区表变更同步至操作系统")]),a._v(" "),s("p",[a._v("partprobe 命令可以在不重启系统的情况下重读分区表")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("partprobe /dev/vdb\n")])])]),s("h4",{attrs:{id:"_6-设置文件系统格式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-设置文件系统格式"}},[a._v("#")]),a._v(" 6. 设置文件系统格式")]),a._v(" "),s("p",[a._v("执行以下命令，将新建分区文件系统设为系统所需格式。")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# mkfs-t文件系统格式分区")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkfs")]),a._v(" -t ext4 /dev/vdb1\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("mke2fs 1.44.1 (24-Mar-2018)\nCreating filesystem with 15728384 4k blocks and 3932160 inodes\nFilesystem UUID: 65aa13b1-8ae4-4d69-bf3d-1e77f4cf3204\nSuperblock backups stored on blocks:\n\t32768, 98304, 163840, 229376, 294912, 819200, 884736, 1605632, 2654208,\n\t4096000, 7962624, 11239424\n\nAllocating group tables: done\nWriting inode tables: done\nCreating journal (65536 blocks): done\nWriting superblocks and filesystem accounting information: done\n")])])]),s("p",[a._v("格式化需要等待一段时间，请观察系统运行状态，不要退出。不同文件系统支持的分区大小不同，请根据您的业务需求选择合适的文件系统。")]),a._v(" "),s("h2",{attrs:{id:"挂载磁盘"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#挂载磁盘"}},[a._v("#")]),a._v(" 挂载磁盘")]),a._v(" "),s("h4",{attrs:{id:"_1-新建挂载目录"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-新建挂载目录"}},[a._v("#")]),a._v(" 1. 新建挂载目录")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 根据个人喜好创建")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mkdir")]),a._v(" /mnt\n")])])]),s("h4",{attrs:{id:"_2-挂载磁盘分区"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-挂载磁盘分区"}},[a._v("#")]),a._v(" 2. 挂载磁盘分区")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mount")]),a._v(" /dev/vdb1 /mnt\n")])])]),s("h4",{attrs:{id:"_3-使用-df-th-查看挂载结果"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-使用-df-th-查看挂载结果"}},[a._v("#")]),a._v(" 3. 使用 "),s("code",[a._v("df -TH")]),a._v(" 查看挂载结果")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("Filesystem     Type      Size  Used Avail Use% Mounted on\nudev           devtmpfs  2.0G  4.1k  2.0G   1% /dev\ntmpfs          tmpfs     397M  5.9M  392M   2% /run\n/dev/vda1      ext4       53G  2.6G   48G   6% /\ntmpfs          tmpfs     2.0G   25k  2.0G   1% /dev/shm\ntmpfs          tmpfs     5.3M     0  5.3M   0% /run/lock\ntmpfs          tmpfs     2.0G     0  2.0G   0% /sys/fs/cgroup\ntmpfs          tmpfs     397M     0  397M   0% /run/user/500\n/dev/vdb1      ext4       64G   55M   60G   1% /mnt\n")])])]),s("p",[a._v("表示新建分区 "),s("code",[a._v("/dev/vdb1")]),a._v(" 已挂载至 "),s("code",[a._v("/mnt")]),a._v("，此时已经可以使用新增加的数据盘了。但是一旦重启云服务器，挂载就会失效，所以我们需要设置自动挂载磁盘。")]),a._v(" "),s("h2",{attrs:{id:"设置自动挂载磁盘"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#设置自动挂载磁盘"}},[a._v("#")]),a._v(" 设置自动挂载磁盘")]),a._v(" "),s("h4",{attrs:{id:"_1-获取磁盘分区的-uuid-信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-获取磁盘分区的-uuid-信息"}},[a._v("#")]),a._v(" 1. 获取磁盘分区的 UUID 信息")]),a._v(" "),s("p",[a._v("执行如下命令，查询磁盘分区的 UUID。")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# blkid 磁盘分区")]),a._v("\nblkid /dev/vdb1\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("/dev/vdb1: UUID=“65aa13b1-8ae4-4d69-bf3d-xxx” TYPE=“ext4” PARTUUID=“695bxx-01”\n")])])]),s("h4",{attrs:{id:"_2-设置自动挂载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-设置自动挂载"}},[a._v("#")]),a._v(" 2. 设置自动挂载")]),a._v(" "),s("p",[a._v("这里我们需要编辑 "),s("code",[a._v("fstab")]),a._v(" 文件，"),s("code",[a._v("fstab")]),a._v(" 文件包含了 Linux 系统可以挂载使用的文件系统的信息。")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("vi")]),a._v(" /etc/fstab\n")])])]),s("p",[a._v("添加以下内容，保存退出")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("UUID=0b3040e2-1367-4abb-841d-ddb0b92693df /mnt/sdc   ext4   defaults    0 2\n")])])]),s("p",[a._v("以内容上仅为示例，具体请以实际情况为准，参数说明如下：")]),a._v(" "),s("ul",[s("li",[a._v("第一列为 UUID，此处填写上面查询到的磁盘分区的 UUID。")]),a._v(" "),s("li",[a._v("第二列为磁盘分区的挂载目录，可以通过 "),s("strong",[a._v("df -TH")]),a._v(" 命令查询。")]),a._v(" "),s("li",[a._v("第三列为磁盘分区的文件系统格式， 可以通过 "),s("strong",[a._v("df -TH")]),a._v(" 命令查询。")]),a._v(" "),s("li",[a._v("第四列为磁盘分区的挂载选项，此处通常设置为defaults即可。")]),a._v(" "),s("li",[a._v("第五列为 Linux dump 备份选项。\n"),s("ul",[s("li",[a._v("0 表示不使用 Linux dump 备份。现在通常不使用 dump 备份，此处设置为 0 即可。")]),a._v(" "),s("li",[a._v("1 表示使用 Linux dump 备份。")])])]),a._v(" "),s("li",[a._v("第六列为 "),s("code",[a._v("fsck")]),a._v(" 选项，即开机时是否使用 "),s("code",[a._v("fsck")]),a._v(" 检查磁盘。\n"),s("ul",[s("li",[a._v("0表示不检验。")]),a._v(" "),s("li",[a._v("挂载点为（/）根目录的分区，此处必须填写 1。根分区设置为 1，其他分区只能从 2 开始，系统会按照数字从小到大依次检查下去。")])])])]),a._v(" "),s("h4",{attrs:{id:"_3-验证挂载信息"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-验证挂载信息"}},[a._v("#")]),a._v(" 3. 验证挂载信息")]),a._v(" "),s("p",[a._v("执行如下命令，卸载已挂载的分区")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# umount 磁盘分区")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("umount")]),a._v(" /dev/vdb1\n")])])]),s("p",[a._v("执行如下命令，将 "),s("code",[a._v("/etc/fstab")]),a._v(" 文件所有内容重新加载。")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mount")]),a._v(" -a\n")])])]),s("p",[a._v("执行如下命令，查询文件系统挂载信息。")]),a._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# mount | grep 挂载目录")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("mount")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("grep")]),a._v(" /mnt\n")])])]),s("p",[a._v("回显类似如下信息，说明自动挂载功能生效：")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("/dev/vdb1 on /mnt type ext4 (rw,relatime,data=ordered)\n")])])]),s("p",[a._v("自此，初始化一个新的 Linux 磁盘的工作已经完成，就可以愉快的玩耍了。")])])}),[],!1,null,null,null);t.default=n.exports}}]);